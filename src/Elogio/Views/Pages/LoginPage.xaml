<Page x:Class="Elogio.Views.Pages.LoginPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
      xmlns:viewModels="clr-namespace:Elogio.ViewModels"
      mc:Ignorable="d"
      d:DesignHeight="600" d:DesignWidth="500"
      Title="Login" d:DataContext="{d:DesignInstance viewModels:LoginViewModel}">

    <Grid VerticalAlignment="Center" HorizontalAlignment="Center">
        <ui:Card Width="350" Padding="24">
            <StackPanel>
                <!-- Logo / Title -->
                <TextBlock Text="ELOGIO"
                           FontSize="32"
                           FontWeight="Bold"
                           HorizontalAlignment="Center"
                           Margin="0,0,0,8" />

                <TextBlock Text="Kelio Time Tracking"
                           FontSize="14"
                           HorizontalAlignment="Center"
                           Foreground="{ui:ThemeResource TextFillColorSecondaryBrush}"
                           Margin="0,0,0,32" />

                <!-- Server URL -->
                <ui:TextBox PlaceholderText="Server URL (https://company.kelio.io)" 
                            Text="{Binding ServerUrl, UpdateSourceTrigger=PropertyChanged}"
                            IsEnabled="{Binding IsLoggingIn, Converter={StaticResource InverseBoolConverter}}"
                            Margin="0,0,0,16">
                    <ui:TextBox.Icon>
                        <ui:SymbolIcon Symbol="Globe24" />
                    </ui:TextBox.Icon>
                </ui:TextBox>

                <!-- Username -->
                <ui:TextBox 
                            PlaceholderText="Username"
                            Text="{Binding Username, UpdateSourceTrigger=PropertyChanged}"
                            IsEnabled="{Binding IsLoggingIn, Converter={StaticResource InverseBoolConverter}}"
                            Margin="0,0,0,16">
                    <ui:TextBox.Icon>
                        <ui:SymbolIcon Symbol="Person24" />
                    </ui:TextBox.Icon>
                </ui:TextBox>

                <!-- Password -->
                <ui:PasswordBox PlaceholderText="Password"
                                Password="{Binding Password, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                IsEnabled="{Binding IsLoggingIn, Converter={StaticResource InverseBoolConverter}}"
                                Margin="0,0,0,16">
                    <ui:PasswordBox.Icon>
                        <ui:SymbolIcon Symbol="Key24" />
                    </ui:PasswordBox.Icon>
                </ui:PasswordBox>

                <!-- Remember Credentials -->
                <CheckBox Content="Remember credentials"
                          IsChecked="{Binding RememberCredentials}"
                          IsEnabled="{Binding IsLoggingIn, Converter={StaticResource InverseBoolConverter}}"
                          Margin="0,0,0,24" />

                <!-- Error Message -->
                <ui:InfoBar Title="Login Failed"
                            Message="{Binding ErrorMessage}"
                            Severity="Error"
                            IsOpen="{Binding HasError}"
                            IsClosable="False"
                            Margin="0,0,0,16" />

                <!-- Login Button -->
                <ui:Button Content="Login"
                           Appearance="Primary"
                           HorizontalAlignment="Stretch"
                           Command="{Binding LoginCommand}"
                           IsEnabled="{Binding IsLoggingIn, Converter={StaticResource InverseBoolConverter}}"
                           Padding="0,12" />

                <!-- Loading Indicator -->
                <StackPanel Orientation="Horizontal"
                            HorizontalAlignment="Center"
                            Margin="0,16,0,0"
                            Visibility="{Binding IsLoggingIn, Converter={StaticResource BoolToVisibilityConverter}}">
                    <ui:ProgressRing IsIndeterminate="True" Width="20" Height="20" />
                    <TextBlock Text="Logging in..."
                               VerticalAlignment="Center"
                               Margin="8,0,0,0" />
                </StackPanel>
            </StackPanel>
        </ui:Card>
    </Grid>
</Page>
